#!/bin/zsh

SESSION_NAME="services"

cd ~/work/compass

developer_setup () {
  cd ~/work/compass/$1
  tmux new-window
  tmux split-window -v -p 30
  tmux select-pane -t 0
  tmux send-keys -t 0 'vim' C-m
  tmux rename-window $1
}

split_setup() {
  cd ~/work/compass/$1
  tmux new-window
  tmux split-window -h
  tmux select-pane -t 0
  tmux send-keys -t 0 'vim' C-m
  tmux rename-window $1
}

tmux has-session -t ${SESSION_NAME}

if [ $? != 0 ]
then
  cd ~/work/compass/core

  tmux new -s ${SESSION_NAME} -d

  tmux split-window -v -p 30
  tmux select-pane -t 0
  tmux send-keys -t 0 'vim' C-m
  tmux rename-window 'core'

  developer_setup 'reporting-service'
  developer_setup 'clv-service'
  developer_setup 'repurchase-rate-service'
  developer_setup 'compass-shared'
  developer_setup 'scheduler'

  tmux select-window -t ${SESSION_NAME}:1
fi

SESSION_NAME="collectors"

tmux has-session -t ${SESSION_NAME}

if [ $? != 0 ]
then
  cd ~/work/compass/hub

  tmux new -s ${SESSION_NAME} -d

  tmux split-window -v -p 30
  tmux select-pane -t 0
  tmux send-keys -t 0 'vim' C-m
  tmux rename-window 'hub'

  developer_setup 'shopify-collector-service'
  developer_setup 'magento-collector-service'
  developer_setup 'googleanalytics-collector-service'
  developer_setup 'facebook-collector-service'
  developer_setup 'amazon-collector-service'
  developer_setup 'stripe-collector-service'
  developer_setup 'paypal-collector-service'
  developer_setup 'collector-common'
  developer_setup 'warren'

  tmux select-window -t ${SESSION_NAME}:1
fi

SESSION_NAME="meetings"

tmux has-session -t ${SESSION_NAME}

if [ $? != 0 ]
then
  cd ~/work/compass/meetings

  tmux new -s ${SESSION_NAME} -d

  tmux send-keys -t 0 'vim' C-m
  tmux rename-window 'meetings'

  cd ~/Desktop/todo
  tmux new-window
  tmux send-keys -t 0 'todo' C-m
  tmux rename-window 'todo'
fi

tmux attach -t ${SESSION_NAME}
